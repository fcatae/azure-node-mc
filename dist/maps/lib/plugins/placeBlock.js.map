{"version":3,"sources":["lib/plugins/placeBlock.js"],"names":[],"mappings":"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","file":"lib/plugins/placeBlock.js","sourcesContent":["const blocks=require(\"minecraft-data\")(require(\"flying-squid\").version).blocks;\nconst Vec3 = require(\"vec3\").Vec3;\n\nconst materialToSound = {\n  undefined: 'stone',\n  'rock': 'stone',\n  'dirt': 'grass',\n  'plant': 'grass',\n  'wool': 'cloth',\n  'web': 'cloth',\n  'wood': 'wood'\n};\n\nmodule.exports.player=function(player,serv)\n{\n  player._client.on(\"block_place\",({direction,heldItem,location} = {}) => {\n    if(direction==-1 || heldItem.blockId==-1 || !blocks[heldItem.blockId]) return;\n    const referencePosition=new Vec3(location.x,location.y,location.z);\n    const directionVector=directionToVector[direction];\n    const placedPosition=referencePosition.plus(directionVector);\n    player.behavior('placeBlock', {\n      direction: directionVector,\n      heldItem: heldItem,\n      id: heldItem.blockId,\n      damage: heldItem.itemDamage,\n      position: placedPosition,\n      reference: referencePosition,\n      playSound: true,\n      sound: 'dig.' + (materialToSound[blocks[heldItem.blockId].material] || 'stone')\n    }, ({direction, heldItem, position, playSound, sound, id, damage}) => {\n      if (playSound) {\n        serv.playSound(sound, player.world, placedPosition.clone().add(new Vec3(0.5, 0.5, 0.5)), {\n          pitch: 0.8\n        });\n      }\n      if(heldItem.blockId!=323){\n          player.changeBlock(position, id, damage);\n      }else if(direction==1){\n        player.setBlock(position, 63, 0);\n          player._client.write('open_sign_entity', {\n              location:position\n          });\n      }else{\n        player.setBlock(position, 68, 0);\n          player._client.write('open_sign_entity', {\n              location:position\n          });\n      }\n    }, async () => {\n      const id = await player.world.getBlockType(placedPosition);\n      const damage = await player.world.getBlockData(placedPosition);\n      player.sendBlock(placedPosition, id, damage);\n    });\n  });\n};\n\nconst directionToVector=[new Vec3(0,-1,0),new Vec3(0,1,0),new Vec3(0,0,-1),new Vec3(0,0,1),new Vec3(-1,0,0),new Vec3(1,0,0)];\n"],"sourceRoot":"/source/"}