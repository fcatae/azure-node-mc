{"version":3,"sources":["lib/plugins/experience.js"],"names":[],"mappings":"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","file":"lib/plugins/experience.js","sourcesContent":["const {distanceToXpLevel,getXpLevel,getBaseXpFromLevel}=require(\"flying-squid\").experience;\n\nmodule.exports.player = function(player) {\n  player.xp = 0;\n  player.displayXp = 0;\n  player.xpLevel = 0;\n\n  player.sendXp = () => {\n    player._client.write('experience', {\n      experienceBar: player.displayXp,\n      level: player.level,\n      totalExperience: player.xp\n    });\n  };\n\n  player.setXpLevel = (level) => {\n    player.xpLevel = level;\n    player.sendXp();\n  };\n\n  player.setDisplayXp = () => {\n    player.displayXp = Math.max(0, Math.min(1, player.displayXp));\n    player.sendXp();\n  };\n\n  player.setXp = (xp, { setLevel=true, setDisplay=true, send=true }={}) => {\n    player.xp = xp;\n    if (setLevel) player.level = getXpLevel(xp);\n    if (setDisplay) player.displayXp = distanceToXpLevel(xp);\n    if (send) player.sendXp();\n  };\n\n  player.commands.add({\n    base: 'xp',\n    info: 'Give yourself experience',\n    usage: '/xp <amount> [player] OR /xp <amount>L [player]',\n    op: true,\n    parse(str) {\n      return str.match(/(-?\\d+)(L)? ?([a-zA-Z0-9_]+)?/) || false;\n    },\n    action(args) {\n      const isLevel = !!args[2];\n      const amt = parseInt(args[1]);\n      const user = args[3] ? serv.getPlayer(args[3]) : player;\n      if (!user) return args[3] + ' is not on this server!';\n\n      if (!isLevel) {\n        user.setXp(user.xp + amt);\n        player.chat('Gave ' + user.username + ' ' + amt + ' xp');\n      } else {\n        const currLevel = getXpLevel(player.xp);\n        const baseCurrLevel = getBaseXpFromLevel(currLevel);\n        const extraXp = player.xp - baseCurrLevel;\n        user.setXp(getBaseXpFromLevel(currLevel + amt) + extraXp);\n        player.chat('Gave ' + user.username + ' ' + amt + ' levels');\n      }\n    }\n  });\n};"],"sourceRoot":"/source/"}